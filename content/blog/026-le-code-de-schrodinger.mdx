---
title: Le code de Schrodinger
description: Wow, 3 mois depuis mon dernier article ?! j'abuse :o Mais j'ai une bonne excuse, j'ai bossÃ© comme une dingue ! ğŸ¤©
date: 2025-11-23
published: true
tags: [Compte-rendu]
image: /img/postimg026.webp
---

Depuis que j'ai commencÃ© Ã  coder ce projet "titanesque" (pour moi il l'est), je suis dans un Ã©tat d'esprit superposÃ©, carrÃ©ment quantique. ğŸˆ
TantÃ´t je me sens invincible, aucun challenge ne me rÃ©siste, je peux tout rÃ©ussir. TantÃ´t, je rÃ©alise la fraude intersidÃ©rale que je suis, je me heurte Ã  des murs infranchissables, et je flippe de ne jamais pouvoir les franchir.

Il y a deux semaines, j'Ã©tais plutÃ´t dans l'Ã©tat "fraude". J'ai Ã©normÃ©ment avancÃ© sur le MVP, quasi terminÃ© mÃªme, mais il y a un gros problÃ¨me sur cette version (on en reparle juste aprÃ¨s), et malgrÃ© les diffÃ©rentes solutions que j'ai testÃ©es, rien ne fonctionne comme je veux.

Pour ceux qui dÃ©barquent, je suis Stella, la comptable qui veut devenir dÃ©veloppeuse. A 40 ans, TDAH et maman de 2 jeunes enfants, le parcours n'est pas simple mais j'ai l'avantage d'Ãªtre passionnÃ©e et dÃ©terminÃ©e.

Alors voilÃ , je suis assez hypÃ©e et en mÃªme temps totalement effrayÃ©e de te prÃ©senter mon oeuvre, mon premier vrai projet, mon application mobile de suivi alimentaire. Tu connais peut-Ãªtre dÃ©jÃ  MyFitnessPal, Yazio, ou encore FatSecret, Le Secret du Poids, et j'en passe. Des applis concurrentes, y'en a des tonnes, mais aucune ne fait ce dont j'ai besoin :

## 1. permettre le suivi de plusieurs personnes

Et j'avoue que j'ai du mal Ã  comprendre que Ã§a n'existe pas... je suis la seule qui ait besoin de suivre mes nutriments et en mÃªme temps ceux de mon foyer ? Les couples qui utilisent MyFitnessPal, ils remplissent leurs aliments en double, chacun dans son tÃ©lÃ©phone ? En plus, moi j'ai besoin de suivre mes calories (le dÃ©ficit calorique c'est le seul rÃ©gime qui fonctionne pour moi parce que j'aime trop manger lol), et pour mes enfants et mon homme, j'ai besoin de suivre uniquement les glucides (pour leur diabÃ¨te). Avec mon app, je peux voir uniquement les informations dont j'ai besoin pour chacun d'eux ^^

Pour Ã§a, il suffit d'aller dans les paramÃ¨tres de la Famille et de sÃ©lectionner pour chaque membre de la famille les nutriments qu'on veut suivre et de renseigner les quotas si nÃ©cessaire !

Par exemple, pour moi je vais suivre uniquement les calories et mettre un quota Ã  1600. Et pour mes enfants, je vais suivre uniquement les glucides pour pouvoir calculer leur insuline, mais pas besoin de quotas !

<div className="flex flex-col md:flex-row w-full justify-between">
  <Image src="../img/026_sc1.jpg" width={300} height={300} alt="screenshot" />
  <Image src="../img/026_sc2.png" width={300} height={300} alt="screenshot" />
</div>

## 2. Ãªtre fluide et fonctionnelle pour la VRAIE VIE !

Quand je sers les repas, ou quand je cuisine, je dois peser chaque Ã©lÃ©ment et renseigner qui mange quoi. Le faire Ã  la main, ou dans une app classique, c'est trÃ¨s fastidieux, et c'est la principale raison qui me pousse Ã  arrÃªter de compter mes calories. ObligÃ©e de compter les glucides pour mes petits par contre, Ã§a c'est pas optionnel ğŸ˜…

Avec mon app, j'ai juste Ã  dÃ©clencher le micro et dire ce que je sers Ã  la volÃ©e, par exemple : "100g de riz pour Ellie et 150g pour Liam, et une compote de pomme chacun". Et BIM ! 2 plateaux remplis avec les totaux de glucides pour chacun. A terme, on pourra mÃªme dÃ©clencher le vocal via "Hey Google, Allymeal !".

Bon jâ€™ai un peu lâ€™impression que Ã§a prend une plombe pour traiter la commande vocale, mais Ã  la limite, c'est pas vraiment gÃªnant ici, puisqu'une fois les assiettes servies, Ã§a me laisse le temps de mettre les petits Ã  table, etc... J'amÃ©liorerais l'UX un peu plus tard, pour afficher la transcription du vocal "en live", un petit son pour indiquer la fin du traitement et la crÃ©ation des plateaux etc...

### Probleme

Par contre, j'en viens au problÃ¨me principal que j'Ã©voquais plus tÃ´t, j'ai des lenteurs un peu partout dans l'app, et je ne sais pas comment identifier les points "fautifs" et comment les rÃ©soudre. Pour que tu comprennes un peu mieux, je dois t'expliquer comment fonctionne l'app globalement, la saisie vocale en particulier, quels choix j'ai dÃ» faire et pourquoi ces choix.

**La barre de recherche**, que tu retrouveras sur toutes les pages principales de l'application, permet de trouver des aliments depuis plusieurs endroits :

- La base de donnÃ©es d'OpenFoodFacts (typiquement, les aliments avec un code barre )
- La base de donnÃ©es de Ciqual Anses (les aliments bruts style carottes, pomme verte, etc... ou les aliments "moyens" style sauce bolognaise, crÃ¨me anglaise, par exemple)
- La base de donnÃ©es de l'utilisateur, qu'il alimente au fur et Ã  mesure en rÃ©cupÃ©rant les aliments qu'il a recherchÃ©, ou scannÃ©, ou bien en crÃ©ant manuellement ses propres aliments "from scratch" si besoin.

<Image src="../img/026_sc5.jpg" width={300} height={300} alt="screenshot" />

**La feature vocale** par contre, va chercher les aliments **UNIQUEMENT** dans
la base de l'utilisateur. Ce qui signifie qu'il va devoir peupler sa base
personnelle pour que le vocal puisse piocher dedans.

### POURQUOI j'ai choisi cette mÃ©thode ?

Parce que sinon, en vocal, si je dis "150g de riz", la recherche va retourner 50 variÃ©tÃ©s de riz diffÃ©rentes (typiquement la totalitÃ© des rÃ©fÃ©rences de riz en vente dans les grandes surfaces franÃ§aises lol) donc je devrais ensuite sÃ©lectionner pour chaque entrÃ©e vocale l'aliment que je voulais rÃ©ellement. Et l'aspect pratique et instantanÃ© du vocal disparaÃ®tâ€¦

PAR CONTRE, pour Ã©viter que l'utilisateur doive passer par la phase trÃ¨s fastidieuse de rentrer d'abord tous ses aliments (et fatalement perdre l'intÃ©rÃªt pour mon app), je propose 2 solutions.

**La premiÃ¨re**, simple et _terriblement efficace_, c'est de "scrapper" simplement ses listes de courses Ã  partir de son drive habituel grÃ¢ce Ã  ma petite extension chrome. Pour l'instant, on peut importer uniquement ses listes prÃ©-enregistrÃ©es (et uniquement sur Auchan car j'ai pas encore fait les autres enseignes mais Ã§a va venir ğŸ˜…) mais Ã  terme, on pourra aussi importer Ã  partir du panier, et Ã  partir d'une page individuelle d'un article.

**La deuxiÃ¨me**, pour les ~~fous~~ courageux qui font encore leurs courses Ã  l'ancienne ğŸ›’, j'ajouterai une feature pour pouvoir scanner ses articles en batch. T'ouvres ton placard/ton frigo, tu scannes tous tes codes barres, et t'as dÃ©jÃ  une grosse partie du "travail" qui est faite.

VoilÃ , tout Ã§a c'Ã©tait la partie qui me rend la plus fiÃ¨re ! ğŸ’ª J'ai mis beaucoup de rÃ©flexion et de temps pour crÃ©er tout ce "flow" et encore, je rentre pas dans les dÃ©tails de

- comment son stockÃ©s les aliments,
- les aliments des plateaux,
- qu'est-ce qui se passe quand on crÃ©Ã© Ã  partir d'OpenFoodFacts ou pas,
- quand on modifie une valeur nutritionnelle,

Il y a tellement de subtilitÃ©s Ã  penser et Ã  prendre en compte, c'est assez colossal Ã  mettre en place (en tout cas pour moi Ã§a l'est ^^).

### Et maintenant, passons Ã  la partie qui fache... ğŸ˜­

TOUT est **LEEEEENT** !!

- CrÃ©er un plateau,
- sÃ©lectionner un plateau,
- ajouter un aliment sur un plateau,
- afficher la liste des aliments,
- passer d'un onglet Ã  un autre,

absolument TOUT prend des plombes... Ã  un point oÃ¹ je me suis mÃªme demandÃ© si c'Ã©tait possible que Ã§a vienne de la brouette qui me sert de tÃ©lÃ©phone ? c'est possible ? (j'ai l'impression que c'est mieux sur ma tablette...) ou bien le fait que je sois sur un environnement de test ? (mon backend est live par contre). Est-ce que c'est prisma qui bride de fou pour que je paye le accelerate ? Est-ce que c'est moi qui ait fait n'importe quoi avec React et qui n'a pas optimisÃ© les renders ? J'ai l'impression que parfois mes composants re-render 1 million de fois pour rien, Ã§a me stresse !! (clairement je pense quâ€™un dev bien calÃ© sâ€™arracherait les cheveux en voyant mon code ğŸ˜…)

J'ai passÃ© des jours et des jours Ã  essayer de rÃ©parer tout Ã§a, une chose aprÃ¨s l'autre. Pour la partie crÃ©ation de plateaux et ajout d'aliments aux plates, j'ai tentÃ© plusieurs solutions.

J'ai voulu implÃ©menter l'optimistic update natif de Tanstack Query, mais apparemment c'Ã©tait pas trÃ¨s compatible avec tRPC ? J'ai eu beau lire la doc et retourner le code dans tous les sens, j'ai pas rÃ©ussi Ã  appliquer la doc Ã  mon cas, donc pour certaines opÃ©rations (modification des quantitÃ©s et suppression d'un item sur un plateau), j'ai pu faire un optimistic "Ã  la mano". Mais pour l'ajout d'un item sur un plateau, Ã§a ne fonctionnait pas correctement, l'item apparaissait, puis disparaissait, puis rÃ©apparaissait... j'y ai passÃ© plusieurs sessions de code sans succÃ¨s.

J'ai ensuite tentÃ© d'utiliser Zustand en combinaison avec un store local. Ca avait pour avantage de :

- rendre les opÃ©rations d'ajout plus rapides pour l'utilisateur
- Ã©viter de faire des requÃªtes serveur Ã  tout bout de champs
- avoir quand mÃªme une sauvegarde dans un store zustand pour Ã©viter de perdre les donnÃ©es si l'app est fermÃ©e ou si elle crashe

Mais au final j'ai tout supprimÃ© car :

- le rÃ©sultat n'Ã©tait pas spÃ©cialement plus rapide (voire c'Ã©tait pire ?)
- Ã§a engendrait de nouveaux bugs et problÃ¨mes
- le code devenait dÃ©gueulasse !

Ma codebase est dÃ©jÃ  plutÃ´t consÃ©quente, avec tous ces ajouts, j'avais l'impression de perdre pied et de faire n'importe quoi.

Du coup, j'ai dÃ©cidÃ© de garder mon code tel qu'il est pour l'instant et tenter de l'optimiser si possible en analysant mieux ce qui se passe sous le capot. Mais je ne sais pas vraiment par oÃ¹ commencer pour identifier les fautifs dans toutes ces lenteurs.

Quand je suis face Ã  un mur comme Ã§a, je me sens un peu paralysÃ©e et je fini par procrastiner, me trouver des excuses pour ne pas coder (j'ai mal dormi, j'ai mal Ã  la tÃªte, j'ai mal au petit doigt... ).

Mais aprÃ¨s quelques jours Ã  tourner autour du pot, j'ai rÃ©ussi Ã  mettre Ã§a de cÃ´tÃ©, en me disant que quelques lenteurs Ã©taient "acceptables" sur mon MVP. J'imagine que c'est optimisable mais je me demande si je suis pas un peu trop exigeante quand je vois que mÃªme les plus grosses applis ont leurs propres lenteurs...

Donc j'ai remis Ã§a Ã  plus tard et alors je suis rentrÃ©e dans une phase d'euphorie du code (la "bipolaire du code" ğŸ˜…) !

J'ai notÃ© ce qu'il me restait Ã  faire pour sortir ce MVP et j'ai plus rÃ©flÃ©chi. Et alors dans ce genre de phase, je peux bosser de 6h du mat Ã  22h du soir sans problÃ¨me. Je m'interromps bien sÃ»r pour mes obligations familiales et dÃ¨s que j'ai du temps de cerveau je retourne bosser, j'adore ces phases ! A cÃ´tÃ© de Ã§a, je peux par exemple passer tout un samedi aprem Ã  jouer Ã  Zelda avec ma fille sans culpabiliser parce que dans tous les cas j'avance ! ğŸ®

Et alors lÃ  du coup, j'ai terminÃ© tout ce qui Ã©tait vraiment non nÃ©gociable pour ce MVP, j'ai mÃªme codÃ© un espace pour rÃ©colter des feedbacks des utilisateurs et qu'ils puissent voter pour les features qu'ils veulent voir arriver et en proposer de nouvelles. Et bien sÃ»r, avec le tableau de bord administrateur qui va bien pour gÃ©rer les nombreux retours de tous mes utilisateurs (comment Ã§a je rÃªve ?! laisse moi tranquille !! ğŸ˜‚).

<div className="flex flex-col md:flex-row w-full justify-between">
  <Image src="../img/026_sc3.jpg" width={300} height={300} alt="screenshot" />
  <Image src="../img/026_sc4.jpg" width={300} height={300} alt="screenshot" />
</div>

Enfin, j'ai crÃ©Ã© mon compte dÃ©veloppeur sur la plateforme d'Android et il m'a fallu une bonne journÃ©e pour toute leur paperasse administrative (pages lÃ©gales obligatoires (mentions lÃ©gales, CGU, RGPD, etc) ğŸ¥±ğŸ˜’) et faire les assets graphiques. Je savais pas qu'on devait aussi Ãªtre designer pour publier une app sur les stores !

Les consignes pour les assets :

- doit faire au moins 1920x1080 (16:9),
- rÃ©solution 1080p,
- ne doit pas dÃ©passer 1Mb,
- sur les screeshots, la batterie et l'etat du rÃ©seau et du wifi doivent Ãªtre au maximum,
- la hauteur ne doit pas dÃ©passer le double de la largeur (au carrÃ© de lâ€™hypothÃ©nuse)
- wooooow !! ğŸ¤¯

Bon du coup, j'ai pas voulu perdre trop de temps sur du design (oÃ¹ je suis clairement pas douÃ©e), j'ai fait 6 screenshots que j'ai insÃ©rÃ© dans des mockups sur Figma et hop, pour l'instant Ã§a ira je pense xD

<Image src="../img/mockups.png" width={600} height={300} alt="screenshot" />

Et lÃ , il me reste encore quelques bricoles Ã  rÃ©gler en plus du build de l'application, mais j'ai encore un peu de temps devant moi puisqu'Android ne veut pas valider mon identitÃ© !! Ben oui, ils veulent comparer mes documents d'identitÃ© avec mes justificatifs de domicile sauf que je suis mariÃ©e !! donc Ã§a correspond plus ... ğŸ™ƒğŸ™ƒğŸ™ƒ

Donc pour trÃ¨s bientÃ´t, je vais lancer la **phase de test** fermÃ© obligatoire avant de pouvoir publier sur le PlayStore, donc si tu as un Android et que tu as envie de mâ€™aider, jâ€™ai besoin de 12 testeurs minimum sur une pÃ©riode de 14 jours pour valider cette phase ! Si tu veux tâ€™inscrire, mets juste ton adresse mail (gmail) sur ma landing page ! (oui je sais elle est moche mais je me suis vraiment pas attardÃ©e dessus pour lâ€™instant ^^)

[https://allymeal.app](https://allymeal.app/)

Enfin voilÃ , lâ€™article me paraÃ®t dÃ©jÃ  pas mal long. A la base, jâ€™avais pensÃ© faire une vidÃ©o, mais jâ€™ai jamais vraiment de moment avec du silence autour de moi, donc jâ€™ai abandonnÃ© lâ€™idÃ©eâ€¦

Nâ€™hÃ©sites pas Ã  me capter sur X ou par mail (liens en bas de page) si tu as envie de me faire un retour ou un petit coucou ğŸ˜Š

A trÃ¨s vite et en attendant, prends soin de toi !! ğŸ’«
